!function(){function e(e){return!e||0===e.length||/^\s*$/.test(e)}function n(e){for(var n=window.location.search.substring(1),o=n.split("&"),r=0;r<o.length;r++){var t=o[r].split("=");if(decodeURIComponent(t[0])==e)return decodeURIComponent(t[1].replace(/\+/g," "))}return void 0}var o=io();o.on("connect",function(){var e=n("name")||"Guest",r=n("room");$(".room-name").text(r),o.emit("joinRoom",{name:e,room:r})}),o.on("message",function(e){var n=moment.utc(e.timestamp),o=$(".messages"),r=$('<li class="list-group-item"></li>');r.append("<p><strong>"+e.name+" "+n.local().format("h:mm a")+": </strong>"+e.text+"</p>"),o.append(r),$(window).scrollTo("max")}),o.on("sendCurrentUsers",function(e){e.users.forEach(function(e){var n='<p id="'+e+'">'+e+"</p>";$(".current-users").append(n)})}),o.on("newUser",function(e){var n='<p id="'+e.name+'">'+e.name+"</p></li>";$(".current-users").append(n)}),o.on("removeUser",function(e){var n="#"+e.name;$(n).remove()}),$("#change-rooms").on("click",function(e){return confirm("Are you sure you want to leave this chatroom?")}),$("#message-input").keypress(function(e){var n=String.fromCharCode(e.keyCode);/[a-zA-Z0-9-_ ]/.test(n)&&$("#message-input").removeClass("message-error")}),$("#message-form").on("submit",function(n){n.preventDefault();var r=$("#message-input");return e(r.val())?void r.addClass("message-error"):(o.emit("message",{text:r.val()}),void r.val(""))}),$("#send-message").on("click",function(){$("#message-form").submit()}),$(document).keyup(function(e){if(27==e.keyCode){var n=confirm("Are you sure you want to leave?");n&&(window.location.href="/index.html")}})}();