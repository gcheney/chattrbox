function isBlankOrEmpty(a){return!a||0===a.length||/^\s*$/.test(a)}function getQueryString(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(decodeURIComponent(e[0])==a)return decodeURIComponent(e[1].replace(/\+/g," "))}}var socket=io();socket.on("connect",function(){var a=getQueryString("name")||"Guest",b=getQueryString("room");$(".room-name").text(b),socket.emit("joinRoom",{name:a,room:b})}),socket.on("message",function(a){var b=moment.utc(a.timestamp),c=$(".messages"),d=$('<li class="list-group-item"></li>');d.append("<p><strong>"+a.name+" "+b.local().format("h:mm a")+": </strong>"+a.text+"</p>"),c.append(d),$(window).scrollTo("max")}),socket.on("sendCurrentUsers",function(a){a.users.forEach(function(a){var b='<p id="'+a+'">'+a+"</p>";$(".current-users").append(b)})}),socket.on("newUser",function(a){var b='<p id="'+a.name+'">'+a.name+"</p></li>";$(".current-users").append(b)}),socket.on("removeUser",function(a){var b="#"+a.name;$(b).remove()}),$(document).ready(function(){$("#change-rooms").on("click",function(a){return confirm("Are you sure you want to leave this chatroom?")}),$("#message-input").keypress(function(a){var b=String.fromCharCode(a.keyCode);/[a-zA-Z0-9-_ ]/.test(b)&&$("#message-input").removeClass("message-error")}),$("#message-form").on("submit",function(a){a.preventDefault();var b=$("#message-input");return isBlankOrEmpty(b.val())?void b.addClass("message-error"):(socket.emit("message",{text:b.val()}),void b.val(""))}),$("#send-message").on("click",function(){$("#message-form").submit()}),$(document).keyup(function(a){if(27==a.keyCode){var b=confirm("Are you sure you want to leave?");b&&(window.location.href="/index.html")}})});